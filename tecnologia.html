<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Geekp√©dia - Tecnologia</title>

    <!-- Estilos -->
    <link rel="stylesheet" href="css/style.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&family=JetBrains+Mono&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />

    <!-- Fundo de part√≠culas -->
    <style>
      #particles-js {
        position: fixed;
        width: 100%;
        height: 100%;
        background: #0d0d0d;
        top: 0;
        left: 0;
        z-index: -1;
      }
      footer {
        text-align: center;
        margin-top: 3rem;
        padding: 1rem;
        color: #888;
      }
    </style>
  </head>
  <body>
    <!-- Fundo animado -->
    <div id="particles-js"></div>

    <!-- Cabe√ßalho -->
    <header>
      <h1><i class="fas fa-microchip"></i> Geekp√©dia - Tecnologia</h1>
      <p>Explore os avan√ßos, curiosidades e revolu√ß√µes do mundo tech.</p>
    </header>

    <!-- Navega√ß√£o -->
    <div id="menuContainer"></div>

    <!-- Conte√∫do -->
    <div class="content" id="tech-section">
      <!-- Artigos carregados dinamicamente v√£o aparecer aqui -->
    </div>

    <!-- Rodap√© -->
    <footer>
      <p>üî¨ Geekp√©dia Tecnologia ¬© 2025 - Todos os direitos reservados.</p>
    </footer>

    <!-- Particles.js -->
    <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
    <script>
      particlesJS("particles-js", {
        particles: {
          number: { value: 90, density: { enable: true, value_area: 800 } },
          color: { value: "#00fff2" },
          shape: { type: "circle" },
          opacity: { value: 0.4 },
          size: { value: 2, random: true },
          line_linked: {
            enable: true,
            distance: 150,
            color: "#00fff2",
            opacity: 0.2,
            width: 1,
          },
          move: { enable: true, speed: 1.5 },
        },
        interactivity: {
          events: {
            onhover: { enable: true, mode: "repulse" },
            onclick: { enable: true, mode: "push" },
          },
        },
        retina_detect: true,
      });
    </script>

    <script type="module">
      import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";

      const supabase = createClient(
        "https://odxqvkwxhbfgcmngdhic.supabase.co",
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9keHF2a3d4aGJmZ2NtbmdkaGljIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMyNjk1MTMsImV4cCI6MjA2ODg0NTUxM30.U47P-s4GNGgk5f_3cQsBxDVLOqp3-jXsOX14Ok8fZk8"
      );

      async function carregarArtigosTecnologia() {
        const container = document.getElementById("tech-section");

        const { data: artigos, error } = await supabase
          .from("artigos")
          .select("id, titulo, descricao")
          .eq("categoria", "tecnologia")
          .order("criado_em", { ascending: false });

        if (error) {
          container.innerHTML = `<p style="color: red;">Erro ao carregar artigos: ${error.message}</p>`;
          return;
        }

        if (!artigos || artigos.length === 0) {
          container.innerHTML = "<p>Nenhum artigo encontrado na categoria Tecnologia.</p>";
          return;
        }

        container.innerHTML = "";

        artigos.forEach((artigo) => {
          const link = document.createElement("a");
          link.href = `detalhe-artigo.html?id=${artigo.id}`;
          link.className = "article-link";

          const divArtigo = document.createElement("div");
          divArtigo.className = "article";

          const titulo = document.createElement("h2");
          titulo.textContent = artigo.titulo;

          const descricao = document.createElement("p");
          descricao.textContent = artigo.descricao;

          divArtigo.appendChild(titulo);
          divArtigo.appendChild(descricao);
          link.appendChild(divArtigo);

          container.appendChild(link);
        });
      }

      carregarArtigosTecnologia();

      // Carregar menu e gerenciar logout
      fetch("menu.html")
        .then((res) => res.text())
        .then((html) => {
          document.getElementById("menuContainer").innerHTML = html;

          const apelido = localStorage.getItem("apelido");
          const apelidoElem = document.getElementById("userName");
          const btnLogout = document.getElementById("btnLogout");

          if (apelido) {
            apelidoElem.textContent = apelido;
            btnLogout.style.display = "inline-block";
          } else {
            apelidoElem.textContent = "Visitante";
            btnLogout.style.display = "none";
          }

          if (btnLogout) {
            btnLogout.addEventListener("click", () => {
              localStorage.removeItem("apelido");
              localStorage.removeItem("usuario_id");
              window.location.href = "index.html";
            });
          }
        });
    </script>
  </body>
</html>
